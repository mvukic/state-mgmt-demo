import{$ as te,$a as A,A as H,B as Q,G as W,I as E,M as y,O as R,P as f,Va as k,Z as h,Za as re,_ as ee,_a as p,b as B,c as L,da as oe,fb as ne,gb as ie,j as g,kb as se,l as I,m as N,mb as x,n as K,pb as v,q as U,r as w,rb as a,sb as ce,t as J,tb as d,w as Y,x as X,y as Z,z as q}from"./chunk-S4BHDGSP.js";import{a as i,b as c,d as M,e as z}from"./chunk-JY5MMDH3.js";var ye={dispatch:!0,functional:!1,useEffectsErrorHandler:!0},D="__@ngrx/effects_create__";function S(e,t={}){let o=t.functional?e:e(),r=i(i({},ye),t);return Object.defineProperty(o,D,{value:r}),o}function Re(e){return Object.getOwnPropertyNames(e).filter(r=>e[r]&&e[r].hasOwnProperty(D)?e[r][D].hasOwnProperty("dispatch"):!1).map(r=>{let n=e[r][D];return i({propertyName:r},n)})}function xe(e){return Re(e)}function fe(e){return Object.getPrototypeOf(e)}function Se(e){return e.constructor.name!=="Object"&&e.constructor.name!=="Function"}function ue(e){return typeof e=="function"}function Fe(e){return e.filter(ue)}function be(e,t,o){let r=fe(e).constructor.name,n=xe(e).map(({propertyName:s,dispatch:u,useEffectsErrorHandler:C})=>{let G=typeof e[s]=="function"?e[s]():e[s],V=C?o(G,t):G;return u===!1?V.pipe(X()):V.pipe(Q()).pipe(I(ge=>({effect:e[s],notification:ge,propertyName:s,sourceName:r,sourceInstance:e})))});return U(...n)}var je=10;function ae(e,t,o=je){return e.pipe(J(r=>(t&&t.handleError(r),o<=1?e:ae(e,t,o-1))))}var F=(()=>{let t=class extends B{constructor(r){super(),r&&(this.source=r)}lift(r){let n=new t;return n.source=this,n.operator=r,n}},e=t;return(()=>{t.\u0275fac=function(n){return new(n||t)(R(se))}})(),(()=>{t.\u0275prov=y({token:t,factory:t.\u0275fac,providedIn:"root"})})(),e})();function b(...e){return w(t=>e.some(o=>typeof o=="string"?o===t.type:o.type===t.type))}var pt=new h("@ngrx/effects Internal Root Guard"),dt=new h("@ngrx/effects User Provided Effects"),mt=new h("@ngrx/effects Internal Root Effects"),lt=new h("@ngrx/effects Internal Root Effects Instances"),Et=new h("@ngrx/effects Internal Feature Effects"),ht=new h("@ngrx/effects Internal Feature Effects Instance Groups"),Te=new h("@ngrx/effects Effects Error Handler",{providedIn:"root",factory:()=>ae}),Me="@ngrx/effects/init",Pe=re(Me);function Oe(e,t){if(e.notification.kind==="N"){let o=e.notification.value;!we(o)&&t.handleError(new Error(`Effect ${Ae(e)} dispatched an invalid action: ${De(o)}`))}}function we(e){return typeof e!="function"&&e&&e.type&&typeof e.type=="string"}function Ae({propertyName:e,sourceInstance:t,sourceName:o}){let r=typeof t[e]=="function";return`"${o}.${String(e)}${r?"()":""}"`}function De(e){try{return JSON.stringify(e)}catch{return e}}var Ce="ngrxOnIdentifyEffects";function Ne(e){return _(e,Ce)}var Ue="ngrxOnRunEffects";function He(e){return _(e,Ue)}var ke="ngrxOnInitEffects";function _e(e){return _(e,ke)}function _(e,t){return e&&t in e&&typeof e[t]=="function"}var pe=(()=>{let t=class extends L{constructor(r,n){super(),this.errorHandler=r,this.effectsErrorHandler=n}addEffects(r){this.next(r)}toActions(){return this.pipe(H(r=>Se(r)?fe(r):r),N(r=>r.pipe(H($e))),N(r=>{let n=r.pipe(q(u=>Ge(this.errorHandler,this.effectsErrorHandler)(u)),I(u=>(Oe(u,this.errorHandler),u.notification)),w(u=>u.kind==="N"&&u.value!=null),Z()),s=r.pipe(Y(1),w(_e),I(u=>u.ngrxOnInitEffects()));return U(n,s)}))}},e=t;return(()=>{t.\u0275fac=function(n){return new(n||t)(R(oe),R(Te))}})(),(()=>{t.\u0275prov=y({token:t,factory:t.\u0275fac,providedIn:"root"})})(),e})();function $e(e){return Ne(e)?e.ngrxOnIdentifyEffects():""}function Ge(e,t){return o=>{let r=be(o,e,t);return He(o)?o.ngrxOnRunEffects(r):r}}var Ve=(()=>{let t=class{get isStarted(){return!!this.effectsSubscription}constructor(r,n){this.effectSources=r,this.store=n,this.effectsSubscription=null}start(){this.effectsSubscription||(this.effectsSubscription=this.effectSources.toActions().subscribe(this.store))}ngOnDestroy(){this.effectsSubscription&&(this.effectsSubscription.unsubscribe(),this.effectsSubscription=null)}},e=t;return(()=>{t.\u0275fac=function(n){return new(n||t)(R(pe),R(x))}})(),(()=>{t.\u0275prov=y({token:t,factory:t.\u0275fac,providedIn:"root"})})(),e})();function vt(...e){let t=e.flat(),o=Fe(t);return te([o,{provide:ee,multi:!0,useValue:()=>{f(ne),f(ie,{optional:!0});let r=f(Ve),n=f(pe),s=!r.isStarted;s&&r.start();for(let u of t){let C=ue(u)?f(u):u;n.addEffects(C)}s&&f(x).dispatch(Pe())}}])}var l=A({source:"Person",events:{init:p(),create:p(),update:p(),delete:p()}});var j=e=>e.houseState,St=v(j,e=>e.viewed),Ft=v(j,e=>e.house);var Mt=v(j,e=>e.people);var m=A({source:"Room",events:{init:p(),create:p(),update:p(),delete:p(),addPerson:p(),removePerson:p(),updatePerson:p()}});var Ct=v(j,e=>e.rooms);function P(e,t){return e.map(o=>o.id!==t.id?o:i(i({},o),t))}function O(e,t){return[...e,t]}function T(e,t){return e.filter(o=>o.id!==t)}function de(e,t,o){return e.rooms.map(r=>r.id!==t?i({},r):c(i({},r),{people:T(r.people,o)}))}function me(e,t){return e.rooms.map(o=>c(i({},o),{people:T(o.people,t)}))}function le(e,t,o){let r=e.find(n=>n.id===o);return t.map(n=>c(i({},n),{people:P(n.people,r)}))}function Ee(e,t,o,r){let n=e.find(s=>s.id===r);return t.map(s=>s.id!==o?s:c(i({},s),{people:O(s.people,n)}))}function he(e){if(e.length===0)return[];let t=Math.floor(Math.random()*e.length);return[structuredClone(e[t])]}var ze=S((e=f(F))=>e.pipe(b(l.update),I(({id:t})=>m.updatePerson({personId:t}))),{functional:!0,dispatch:!0}),Qt={onUpdate:ze};var $=()=>({house:{id:"",name:""},people:[],rooms:[],viewed:!1});var mo=ce($(),a(d.create,(e,{name:t})=>c(i({},e),{house:{id:crypto.randomUUID(),name:t},viewed:!0})),a(d.init,(e,t)=>c(i({},e),{house:{id:t.id,name:t.name},viewed:!0})),a(d.update,(e,{name:t})=>c(i({},e),{house:c(i({},e.house),{name:t})})),a(d.close,()=>i({},$())),a(l.create,(e,{firstName:t,lastName:o})=>c(i({},e),{people:O(e.people,{id:crypto.randomUUID(),firstName:t,lastName:o})})),a(l.update,(e,t)=>c(i({},e),{people:P(e.people,t)})),a(l.init,(e,{people:t})=>c(i({},e),{people:t})),a(l.delete,(e,{personId:t})=>c(i({},e),{people:T(e.people,t),rooms:me(e,t)})),a(m.create,(e,{name:t,designation:o})=>c(i({},e),{rooms:O(e.rooms,{id:crypto.randomUUID(),name:t,designation:o,people:he(e.people)})})),a(m.init,(e,{rooms:t})=>c(i({},e),{rooms:t})),a(m.update,(e,t)=>c(i({},e),{rooms:P(e.rooms,t)})),a(m.delete,(e,{roomId:t})=>c(i({},e),{rooms:T(e.rooms,t)})),a(m.removePerson,(e,{roomId:t,personId:o})=>c(i({},e),{rooms:de(e,t,o)})),a(m.updatePerson,(e,{personId:t})=>c(i({},e),{rooms:le(e.people,e.rooms,t)})),a(m.addPerson,(e,{roomId:t,personId:o})=>c(i({},e),{rooms:Ee(e.people,e.rooms,t,o)})));var ve=(()=>{var t;let o=class{constructor(){z(this,t,f(x))}createHouse(n){return g({id:crypto.randomUUID(),name:n}).pipe(E(s=>M(this,t).dispatch(d.init(s))))}getHouse(n){return g({id:crypto.randomUUID(),name:`House ${n}`}).pipe(E(s=>M(this,t).dispatch(d.init(s))))}getPeople(n){return g([{id:"b3bfe33f-775b-4ac4-a144-b61aad48cf9d",firstName:"a",lastName:"d"},{id:"957a081a-4bf2-43f7-af0f-925f6dbbc752",firstName:"b",lastName:"c"}]).pipe(E(s=>M(this,t).dispatch(l.init({people:s}))))}getRooms(n){return g([{id:"e49f6093-d597-4fb9-a10d-ae4de58993dd",name:"ab",designation:"de",people:[]},{id:"d9cecf49-6add-43d4-9588-86abbbde4116",name:"bc",designation:"cd",people:[{id:"957a081a-4bf2-43f7-af0f-925f6dbbc752",firstName:"Person 2",lastName:"Person 2"}]}]).pipe(E(s=>M(this,t).dispatch(m.init({rooms:s}))))}},e=o;return t=new WeakMap,(()=>{o.\u0275fac=function(s){return new(s||o)}})(),(()=>{o.\u0275prov=y({token:o,factory:o.\u0275fac,providedIn:"root"})})(),e})();var Be=S((e=f(F),t=f(k))=>e.pipe(b(d.create),E(()=>t.navigateByUrl("edit"))),{functional:!0,dispatch:!1}),Le=S((e=f(F),t=f(ve))=>e.pipe(b(d.open),W(({id:o})=>K([t.getHouse(o),t.getPeople(o),t.getRooms(o)]))),{functional:!0,dispatch:!1}),Ke=S((e=f(F),t=f(k))=>e.pipe(b(d.close),E(()=>t.navigateByUrl("create"))),{functional:!0,dispatch:!1}),Ho={onCreate:Be,onClose:Ke,onOpen:Le};export{S as a,F as b,b as c,vt as d,l as e,Ft as f,Mt as g,m as h,Ct as i,Qt as j,Ho as k,mo as l};
