import{$ as te,$a as p,A as Q,B as k,C as W,H as ee,J as E,N as I,P as R,Q as f,Wa as _,_ as h,_a as ne,aa as oe,ab as A,b as L,c as K,ea as re,gb as ie,hb as se,j as g,l as y,lb as ce,m as N,n as J,nb as x,q as U,qb as v,r as w,sb as a,t as Y,tb as fe,ub as d,w as X,x as Z,y as H,z as q}from"./chunk-OMWHFBQT.js";import{a as i,b as c,d as M,e as B}from"./chunk-JY5MMDH3.js";var Re={dispatch:!0,functional:!1,useEffectsErrorHandler:!0},D="__@ngrx/effects_create__";function S(e,t={}){let o=t.functional?e:e(),r=i(i({},Re),t);return Object.defineProperty(o,D,{value:r}),o}function xe(e){return Object.getOwnPropertyNames(e).filter(r=>e[r]&&e[r].hasOwnProperty(D)?e[r][D].hasOwnProperty("dispatch"):!1).map(r=>{let n=e[r][D];return i({propertyName:r},n)})}function Se(e){return xe(e)}function ue(e){return Object.getPrototypeOf(e)}function Fe(e){return e.constructor.name!=="Object"&&e.constructor.name!=="Function"}function ae(e){return typeof e=="function"}function be(e){return e.filter(ae)}function je(e,t,o){let r=ue(e).constructor.name,n=Se(e).map(({propertyName:s,dispatch:u,useEffectsErrorHandler:C})=>{let V=typeof e[s]=="function"?e[s]():e[s],z=C?o(V,t):V;return u===!1?z.pipe(Z()):z.pipe(W()).pipe(y(ye=>({effect:e[s],notification:ye,propertyName:s,sourceName:r,sourceInstance:e})))});return U(...n)}var Te=10;function pe(e,t,o=Te){return e.pipe(Y(r=>(t&&t.handleError(r),o<=1?e:pe(e,t,o-1))))}var F=(()=>{let t=class extends L{constructor(r){super(),r&&(this.source=r)}lift(r){let n=new t;return n.source=this,n.operator=r,n}},e=t;return(()=>{t.\u0275fac=function(n){return new(n||t)(R(ce))}})(),(()=>{t.\u0275prov=I({token:t,factory:t.\u0275fac,providedIn:"root"})})(),e})();function b(...e){return w(t=>e.some(o=>typeof o=="string"?o===t.type:o.type===t.type))}var dt=new h("@ngrx/effects Internal Root Guard"),mt=new h("@ngrx/effects User Provided Effects"),lt=new h("@ngrx/effects Internal Root Effects"),Et=new h("@ngrx/effects Internal Root Effects Instances"),ht=new h("@ngrx/effects Internal Feature Effects"),vt=new h("@ngrx/effects Internal Feature Effects Instance Groups"),Me=new h("@ngrx/effects Effects Error Handler",{providedIn:"root",factory:()=>pe}),Pe="@ngrx/effects/init",Oe=ne(Pe);function we(e,t){if(e.notification.kind==="N"){let o=e.notification.value;!Ae(o)&&t.handleError(new Error(`Effect ${De(e)} dispatched an invalid action: ${Ce(o)}`))}}function Ae(e){return typeof e!="function"&&e&&e.type&&typeof e.type=="string"}function De({propertyName:e,sourceInstance:t,sourceName:o}){let r=typeof t[e]=="function";return`"${o}.${String(e)}${r?"()":""}"`}function Ce(e){try{return JSON.stringify(e)}catch{return e}}var Ne="ngrxOnIdentifyEffects";function Ue(e){return $(e,Ne)}var He="ngrxOnRunEffects";function ke(e){return $(e,He)}var _e="ngrxOnInitEffects";function $e(e){return $(e,_e)}function $(e,t){return e&&t in e&&typeof e[t]=="function"}var de=(()=>{let t=class extends K{constructor(r,n){super(),this.errorHandler=r,this.effectsErrorHandler=n}addEffects(r){this.next(r)}toActions(){return this.pipe(k(r=>Fe(r)?ue(r):r),N(r=>r.pipe(k(Ge))),N(r=>{let n=r.pipe(Q(u=>Ve(this.errorHandler,this.effectsErrorHandler)(u)),y(u=>(we(u,this.errorHandler),u.notification)),w(u=>u.kind==="N"&&u.value!=null),q()),s=r.pipe(X(1),w($e),y(u=>u.ngrxOnInitEffects()));return U(n,s)}))}},e=t;return(()=>{t.\u0275fac=function(n){return new(n||t)(R(re),R(Me))}})(),(()=>{t.\u0275prov=I({token:t,factory:t.\u0275fac,providedIn:"root"})})(),e})();function Ge(e){return Ue(e)?e.ngrxOnIdentifyEffects():""}function Ve(e,t){return o=>{let r=je(o,e,t);return ke(o)?o.ngrxOnRunEffects(r):r}}var ze=(()=>{let t=class{get isStarted(){return!!this.effectsSubscription}constructor(r,n){this.effectSources=r,this.store=n,this.effectsSubscription=null}start(){this.effectsSubscription||(this.effectsSubscription=this.effectSources.toActions().subscribe(this.store))}ngOnDestroy(){this.effectsSubscription&&(this.effectsSubscription.unsubscribe(),this.effectsSubscription=null)}},e=t;return(()=>{t.\u0275fac=function(n){return new(n||t)(R(de),R(x))}})(),(()=>{t.\u0275prov=I({token:t,factory:t.\u0275fac,providedIn:"root"})})(),e})();function gt(...e){let t=e.flat(),o=be(t);return oe([o,{provide:te,multi:!0,useValue:()=>{f(ie),f(se,{optional:!0});let r=f(ze),n=f(de),s=!r.isStarted;s&&r.start();for(let u of t){let C=ae(u)?f(u):u;n.addEffects(C)}s&&f(x).dispatch(Oe())}}])}var l=A({source:"Person",events:{init:p(),create:p(),update:p(),delete:p()}});var j=e=>e.houseState,Ft=v(j,e=>e.viewed),bt=v(j,e=>e.house);var Pt=v(j,e=>e.people);var m=A({source:"Room",events:{init:p(),create:p(),update:p(),delete:p(),addPerson:p(),removePerson:p(),updatePerson:p()}});var Nt=v(j,e=>e.rooms);function P(e,t){return e.map(o=>o.id!==t.id?o:i(i({},o),t))}function O(e,t){return[...e,t]}function T(e,t){return e.filter(o=>o.id!==t)}function me(e,t,o){return e.rooms.map(r=>r.id!==t?i({},r):c(i({},r),{people:T(r.people,o)}))}function le(e,t){return e.rooms.map(o=>c(i({},o),{people:T(o.people,t)}))}function Ee(e,t,o){let r=e.find(n=>n.id===o);return t.map(n=>c(i({},n),{people:P(n.people,r)}))}function he(e,t,o,r){let n=e.find(s=>s.id===r);return t.map(s=>s.id!==o?s:c(i({},s),{people:O(s.people,n)}))}function ve(e){if(e.length===0)return[];let t=Math.floor(Math.random()*e.length);return[structuredClone(e[t])]}var Be=S((e=f(F))=>e.pipe(b(l.update),y(({id:t})=>m.updatePerson({personId:t}))),{functional:!0,dispatch:!0}),Wt={onUpdate:Be};var G=()=>({house:{id:"",name:""},people:[],rooms:[],viewed:!1});var lo=fe(G(),a(d.create,(e,{name:t})=>c(i({},e),{house:{id:crypto.randomUUID(),name:t},viewed:!0})),a(d.init,(e,t)=>c(i({},e),{house:{id:t.id,name:t.name},viewed:!0})),a(d.update,(e,{name:t})=>c(i({},e),{house:c(i({},e.house),{name:t})})),a(d.close,()=>i({},G())),a(l.create,(e,{firstName:t,lastName:o})=>c(i({},e),{people:O(e.people,{id:crypto.randomUUID(),firstName:t,lastName:o})})),a(l.update,(e,t)=>c(i({},e),{people:P(e.people,t)})),a(l.init,(e,{people:t})=>c(i({},e),{people:t})),a(l.delete,(e,{personId:t})=>c(i({},e),{people:T(e.people,t),rooms:le(e,t)})),a(m.create,(e,{name:t,designation:o})=>c(i({},e),{rooms:O(e.rooms,{id:crypto.randomUUID(),name:t,designation:o,people:ve(e.people)})})),a(m.init,(e,{rooms:t})=>c(i({},e),{rooms:t})),a(m.update,(e,t)=>c(i({},e),{rooms:P(e.rooms,t)})),a(m.delete,(e,{roomId:t})=>c(i({},e),{rooms:T(e.rooms,t)})),a(m.removePerson,(e,{roomId:t,personId:o})=>c(i({},e),{rooms:me(e,t,o)})),a(m.updatePerson,(e,{personId:t})=>c(i({},e),{rooms:Ee(e.people,e.rooms,t)})),a(m.addPerson,(e,{roomId:t,personId:o})=>c(i({},e),{rooms:he(e.people,e.rooms,t,o)})));var ge=(()=>{var t;let o=class{constructor(){B(this,t,f(x))}createHouse(n){return g({id:crypto.randomUUID(),name:n}).pipe(E(s=>M(this,t).dispatch(d.init(s))))}getHouse(n){return g({id:crypto.randomUUID(),name:`House ${n}`}).pipe(H(1e3),E(s=>M(this,t).dispatch(d.init(s))))}getPeople(n){return g([{id:"b3bfe33f-775b-4ac4-a144-b61aad48cf9d",firstName:"a",lastName:"d"},{id:"957a081a-4bf2-43f7-af0f-925f6dbbc752",firstName:"b",lastName:"c"}]).pipe(H(1e3),E(s=>M(this,t).dispatch(l.init({people:s}))))}getRooms(n){return g([{id:"e49f6093-d597-4fb9-a10d-ae4de58993dd",name:"ab",designation:"de",people:[]},{id:"d9cecf49-6add-43d4-9588-86abbbde4116",name:"bc",designation:"cd",people:[{id:"957a081a-4bf2-43f7-af0f-925f6dbbc752",firstName:"Person 2",lastName:"Person 2"}]}]).pipe(E(s=>M(this,t).dispatch(m.init({rooms:s}))))}},e=o;return t=new WeakMap,(()=>{o.\u0275fac=function(s){return new(s||o)}})(),(()=>{o.\u0275prov=I({token:o,factory:o.\u0275fac,providedIn:"root"})})(),e})();var Le=S((e=f(F),t=f(_))=>e.pipe(b(d.create),E(()=>t.navigateByUrl("edit"))),{functional:!0,dispatch:!1}),Ke=S((e=f(F),t=f(ge))=>e.pipe(b(d.open),ee(({id:o})=>J([t.getHouse(o),t.getPeople(o),t.getRooms(o)]))),{functional:!0,dispatch:!1}),Je=S((e=f(F),t=f(_))=>e.pipe(b(d.close),E(()=>t.navigateByUrl("create"))),{functional:!0,dispatch:!1}),ko={onCreate:Le,onClose:Je,onOpen:Ke};export{S as a,F as b,b as c,gt as d,l as e,bt as f,Pt as g,m as h,Nt as i,Wt as j,ko as k,lo as l};
